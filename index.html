<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Forgot Password</title>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
    import { getAuth, sendPasswordResetEmail, fetchSignInMethodsForEmail } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-auth.js";

    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyAXZgxM6PU-T3D2811KnBszblRWju7rv1Y",
      authDomain: "dws-management.firebaseapp.com",
      projectId: "dws-management",
      storageBucket: "dws-management.appspot.com",
      messagingSenderId: "23827231923",
      appId: "1:23827231923:web:97141b6d19c7cd109d2cc6",
      measurementId: "G-L14GLJDYW7"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    // Reset password function
    async function resetPassword() {
      const email = document.getElementById("email").value.trim();

      if (!email) {
        alert("Please enter your email.");
        return;
      }

      try {
        // Check if the email is registered with Firebase (if any sign-in method exists)
        const methods = await fetchSignInMethodsForEmail(auth, email);

        if (methods.length === 0) {
          // If no methods are returned, this means the email is not registered
          alert("No user found with this email address.");
          return;
        }

        // If the email is registered, send the reset password email
        await sendPasswordResetEmail(auth, email);
        alert("Password reset email sent! Please check your inbox.");
      } catch (error) {
        console.error("Error during password reset:", error);
        if (error.code === 'auth/invalid-email') {
          alert("Invalid email format.");
        } else if (error.code === 'auth/user-not-found') {
          alert("No user found with this email address.");
        } else {
          alert("An error occurred: " + error.message);
        }
      }
    }

    window.resetPassword = resetPassword;
  </script>
</head>
<body>
  <h2>Forgot Password</h2>
  <label for="email">Enter your email:</label>
  <input type="email" id="email" required placeholder="Enter email">
  <button onclick="resetPassword()">Send Reset Link</button>
</body>
</html>